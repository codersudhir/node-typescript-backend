'use strict'
const http = require('http');

class postalData {
  async getPostData(pinCode) {
    
    let result = new Promise((resolve, reject) => {
      http.get('http://www.postalpincode.in/api/pincode/' + pinCode, function (res) {
        // Detect a redirect
        if (res.statusCode > 300 && res.statusCode < 400 && res.headers.location) {
            // The location for some (most) redirects will only contain the path,  not the hostname;
            // detect this and add the host to the path.
            if (url.parse(res.headers.location).hostname) {
                  // Hostname included; make request to res.headers.location
            } else {
                  // Hostname not included; get host from requested URL (url.parse()) and prepend to location.
            }
    
        // Otherwise no redirect; capture the response as normal            
        } else {
            var data = '';
            res.on('data', function (chunk) {
                data += chunk;
            }).on('end', function () {
              resolve(data)
                // Do something with 'data'
            });
        }
    });
    })
    const newLocal = await result
    return newLocal
  }
}

module.exports = {
  postalData
}
